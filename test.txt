flowchart TD
    %% Define Styles
    classDef devHub fill:#e3f2fd,stroke:#1565c0,stroke-width:2px;
    classDef prodHub fill:#ffebee,stroke:#c62828,stroke-width:2px;
    classDef devSpoke fill:#e0f2f1,stroke:#00695c,stroke-width:2px;
    classDef prodSpoke fill:#fbe9e7,stroke:#bf360c,stroke-width:2px;
    classDef shared fill:#f3e5f5,stroke:#4a148c,stroke-width:2px;

    subgraph Org_Master ["Shared Organization Master"]
        ListRole[("IAM Role:\nlist-org-role")]
    end

    subgraph PTDEV_Environment ["PTDEV Environment (Restricted)"]
        direction TB
        DevHub["Hub: ptdev-sec-control"]
        DevJob("CronJob: Dev Scanner")
        
        DevJob -->|1. Assume| DevHub
    end

    subgraph Target_Dev ["Allowed Targets (Non-Prod)"]
        PocSpoke[("Account: POC\n(read-role)")]
        PtdevSpoke[("Account: PTDEV\n(read-role)")]
    end

    subgraph Target_Prod ["Forbidden Targets (Production)"]
        ProdSpoke[("Account: PROD\n(read-role)")]
    end

    %% ALLOWED PATHS
    DevHub -->|2. List Accounts| ListRole
    DevHub -->|3. Audit| PocSpoke
    DevHub -->|3. Audit| PtdevSpoke

    %% BLOCKED PATHS (The Enforcement)
    DevHub -.->|X ACCESS DENIED X| ProdSpoke

    %% Styling
    class DevHub,DevJob devHub;
    class ListRole,Org_Master shared;
    class PocSpoke,PtdevSpoke devSpoke;
    class ProdSpoke,Target_Prod prodSpoke;
    
    %% Link Styling
    linkStyle 4 stroke:#ff0000,stroke-width:4px,stroke-dasharray: 5 5;